# Лабораторная работа 3. "Умножение матрицы на матрицу в MPI $2D$ решетка"

## Описание алгоритма

Вычисляется произведение $С = А × В$, где $А$ – матрица размера $n_1 × n_2$ и $В$ – матрица $n_2 × n_3$, $С$ – матрица результатов размера $n_1 × n_3$. Исходные матрицы первоначально доступны на нулевом процессе, и матрица результатов возвращена в нулевой процесс.

Параллельное выполнение алгоритма осуществляется на двумерной ($2D$) решетке компьютеров размером $p_1 × p_2$. Матрица $А$ разрезана на $p_1$ горизонтальных полос, матрица $В$ разрезана на $p_2$ вертикальных полос, и матрица результата $C$ разрезана на $p_1 × p_2$ подматрицы (или субматрицы).

Каждый компьютер $(i,j)$ вычисляет произведение $i$-й горизонтальной полосы матрицы $A$ и $j$-й вертикальной полосы матрицы $B$, произведение получено в подматрице
$(i,j)$ матрицы $C$.

Последовательные стадии вычисления:
1. Матрица А распределяется по горизонтальным полосам вдоль координаты (x,0).
2. Матрица B распределяется по вертикальным полосам вдоль координаты (0,y).
3. Полосы А распространяются в измерении y.
4. Полосы B распространяются в измерении х.
5. Каждый процесс вычисляет одну подматрицу произведения.
6. Матрица C собирается из (x,y) плоскости.

![](img/algorithm.png)
   
Осуществлять пересылки между компьютерами во время вычислений не нужно, т. к.
все полосы матрицы $А$ пересекаются со всеми полосами матрицы $B$ в памяти компьютеров
системы.

## Задание

1. Реализовать параллельный алгоритм умножения матрицы на матрицу при $2D$ решетке.
2. Исследовать производительность параллельной программы в зависимости от размера матрицы и размера решетки.
1. Выполнить профилирование программы с помощью $MPE$ при использовании 16-и ядер.